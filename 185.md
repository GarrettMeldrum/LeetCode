with ranking as (
    select
        e.id,
        e.name,
        e.salary,
        e.departmentId,
        dense_rank() over (partition by e.departmentId order by e.salary desc) as 'rank_value'
    from
        Employee e
)
select 
    d.name as 'Department',
    ranking.name as 'Employee',
    ranking.salary as 'Salary'
from
    ranking
left join Department d on ranking.departmentId = d.id
where ranking.rank_value <= 3
order by Department, Salary desc
