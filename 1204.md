with rank_table as (
    select 
        turn, 
        person_id, 
        person_name, 
        weight, 
        sum(weight) over (order by turn) as 'sum_weight' 
    from Queue
)

select 
    person_name 
from 
    rank_table 
where 
    sum_weight <= 1000 
order by 
    turn desc 
limit 1
